<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kh.redclip.notice.model.dao.NoticeMapper">
	<select id="noticeCount" resultType="_int">
		SELECT
				COUNT(*)
		  FROM
		  		TB_NOTICE
	</select> 
	
	
<select id="selectNotice" parameterType="map" resultType="notice">
    SELECT
	        NOTICE_NO noticeNo,
	        NOTICE_TITLE noticeTitle,
	        NOTICE_CONTENT noticeContent,
	        NOTICE_DATE noticeDate,
	        NOTICE_TYPE noticeType,
	        USER_ID userId
    FROM
   		 (
	        SELECT
	            NOTICE_NO,
	            NOTICE_TITLE,
	            NOTICE_CONTENT,
	            NOTICE_DATE,
	            NOTICE_TYPE,
	            USER_ID,
	            ROWNUM RNUM
	        FROM
        (
            SELECT
                NOTICE_NO,
                NOTICE_TITLE,
                NOTICE_CONTENT,
                NOTICE_DATE,
                NOTICE_TYPE,
                USER_ID
            FROM
                TB_NOTICE
            <if test="type == 2">
                WHERE NOTICE_TYPE = '공지'
            </if>
            <if test="type == 3">
                WHERE NOTICE_TYPE = '이벤트'
            </if>
            ORDER BY NOTICE_NO DESC
        )
    )
    WHERE RNUM BETWEEN #{startValue} AND #{endValue}
</select>
	
<insert id="insertNotice" parameterType="notice" >
    INSERT 
      INTO 
      		TB_NOTICE
    (
			NOTICE_NO,
	        NOTICE_TITLE,
	        NOTICE_CONTENT,
	        USER_ID,
	        NOTICE_TYPE,
	        NOTICE_DATE
    )
    VALUES
    (
    	SEQ_NOTICE.NEXTVAL,
    	  #{noticeTitle},
    	  #{noticeContent},
    	  #{userId},
    	  #{noticeType},
    	  SYSDATE
    )

</insert>
	
	<delete id="deleteNotice" parameterType="list">
    DELETE 
    FROM
        TB_NOTICE
    WHERE 
        NOTICE_NO 
    IN 
    <foreach item="noticedel" collection="list" open="(" separator="," close=")">
        #{noticedel}
    </foreach>
    
</delete>


 <select id="detailNotice"  resultType="notice" parameterType="int">
        SELECT 
        		NOTICE_NO noticeNo,
		        NOTICE_TITLE noticeTitle,
		        NOTICE_CONTENT noticeContent,
		        USER_ID userId,
		        NOTICE_TYPE noticeType,
		        NOTICE_DATE noticeDate
        FROM 
        		TB_NOTICE
        WHERE 
        		NOTICE_NO = #{noticeNo}
   </select>
<update id="updateNotice" parameterType="notice" >
UPDATE 
		TB_NOTICE 
SET 
		NOTICE_TITLE = #{noticeTitle}, 
	    NOTICE_CONTENT = #{noticeContent}, 
	    NOTICE_TYPE = #{noticeType}
WHERE 
		NOTICE_NO = #{noticeNo}
</update>

</mapper>